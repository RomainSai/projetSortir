<!doctype html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{% block title %}Document {% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="shortcut icon" href="{{ asset('images/enifavicon.png') }}" type="image/png">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" href="{{ asset('css/styles.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
            integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
            crossorigin=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="{{ asset('js/accueiljs.js') }}"></script>
</head>
<header>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed " id="dlDropDown" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="{{ path('homepage') }}">
                    <img alt="Logo" src="{{ asset('images/eniphoto.jpg') }}" class="pull-left">
                    <span class="stylelogo"> &nbsp; &nbsp; Sortir.com</span>
                </a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    {% block hyperlien %}
                        {% if is_granted('ROLE_ADMIN') %}
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('participant_inscription') }}"><span></span>
                                    Participant</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('ville_listeVilles') }}"><span></span> Villes</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('site_index') }}"><span></span> Sites</a>
                            </li>
                        {% endif %}
                    {% endblock %}
                    {% if app.user %}
                        <li class="nav-item">
                            <a class="nav-link accueil" href="{{ path('homepage') }}"><span></span> Accueil</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                               href="{{ path('participant_afficherProfil', {id: app.user.id}) }}"><span></span> Mon
                                Profil</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ path('logout') }}"><span></span> Se déconnecter</a>
                        </li>
                    {% endif %}
                </ul>
            </div>

        </div>
    </nav>
</header>
{#------------------------------------------------Body---------------------------------------------------------------#}
<body>
<div class="container-fluid">
    {% block contenu %}
    <div class="row">
        <div class="col-sm-9">
            {% for message in app.flashes('error') %}
                <div class="alert alert-danger">
                    {{ message }}
                </div>
            {% endfor %}
            {% for message in app.flashes('success') %}
                <div class="alert alert-success">
                    {{ message }}
                </div>
            {% endfor %}
        </div>

        <div class="col-sm-2" id="cover">
            <p> Date du jour : {{ "now" | date('Y-m-d') }}</p>
            <p> Bonjour : {{ app.user }}</p>
        </div>
    </div>


    <div class="row">
        <fieldset>
            <div class="col-sm-5">
                <legend> Filtrer les sorties</legend>
                <br>
                <div class="row">
                    <div class="col-sm-5">
                        <label for="site">Site :</label>
                    </div>
                    <div class="col-sm-6">
                        <select onchange="triParSite();" class="form-control" id="LeSelect">
                            <option>.................................................</option>
                            {% for site in sites %}
                                <option>{{ site.nomSite }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <br>

                <div class="row">
                    <div class="col-sm-6">
                        <label for="nom"> Le nom de la sortie contient : </label>
                    </div>
                    <div class="col-sm-5">
                        <div class="input-group">
                            <input id="myInputSearch" type="text" class="form-control" placeholder="search">
                            <div class="input-group-btn">
                                <button class="btn btn-default" type="submit">
                                    <i class="glyphicon glyphicon-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <br>

                <form action="{{ path('homepage') }}" method="post">
                    <div class="row">
                        <div class="col-sm-11">

                            Entre:&nbsp; &nbsp;
                            <input type="date" name="debut">&nbsp;<span class="glyphicon glyphicon-calendar"> </span>
                            &nbsp; et &nbsp;
                            <input type="date" name="fin">&nbsp;<span class="glyphicon glyphicon-calendar"> </span>
                        </div>
                    </div>
            </div>


            <div class="col-sm-3">

                <br><br><br>
                <div class="checkbox">
                    <label><input type="checkbox" id="sortieQueJorganise"
                                  onclick="myFunction(this,'sorties1','sortie0')"
                                  value=""> Sorties dont je suis l'organisateur/trice</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="sortieOuJeParticipe"
                                  onclick="myFunction(this,'sorties2','sortie0')"
                                  value="">Sorties auxquelles je suis inscrit/e</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="sortiePasInscript" onclick="myFunction(this,'sorties3','sortie0')"
                                  value="">Sorties auxquelles je ne suis pas inscrit/e</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="sortieFinis" onclick="myFunction(this,'sorties4','sortie0')"
                                  value="">Sorties
                        passées</label>
                </div>
            </div>


            <div class="col-sm-2 col-sm-offset-1">
                <br><br><br><br>
                <button id="bouton_Recherche" type="submit" class="btn btn-info btn-lg btn-block">
                    <span class="glyphicon glyphicon-search"></span> Rechercher
                </button>
                </form>
            </div>

    </div>


    <br>
    <div class="sortie0" id="text0">
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="table-responsive" style="max-height: 350px">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom de la sortie</th>
                            <th>Date de la sortie</th>
                            <th>Clotûre</th>
                            <th>Inscripts/places</th>
                            <th>Etat</th>
                            <th>Organisateur</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="myTable">

                        {% for sortie in sorties %}
                            {% set dateSortie = sortie.getDateDebutSortie() %}
                            {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                <tr>
                                    <td>{{ sortie.nomSortie }}</td>
                                    <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                    <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                    {% set compteur = 0 %}
                                    {% for participant  in sortie.participants %}
                                        {% set compteur = compteur+1 %}
                                    {% endfor %}
                                    <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                    <td>{{ sortie.etat }}</td>
                                    <td>{{ sortie.participant }}</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                            </li>

                                            {% if app.user == sortie.participant %}
                                                <li>
                                                    <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                </li>
                                            {% endif %}
                                            {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                        désister</a>
                                                </li>
                                            {% else %}
                                                {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                    </li>
                                                {% endif %}

                                            {% endif %}
                                        </ul>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <br>
    <div class="sorties1" id="text1" hidden>
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="table-responsive" style="max-height: 350px">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom de la sortie</th>
                            <th>Date de la sortie</th>
                            <th>Clotûre</th>
                            <th>Inscripts/places</th>
                            <th>Etat</th>
                            <th>Organisateur</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="myTable">
                        {% for sortie in sorties %}
                            {% if app.user == sortie.participant %}
                                {% set dateSortie = sortie.getDateDebutSortie() %}
                                {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                    <tr>
                                        <td>{{ sortie.nomSortie }}</td>
                                        <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                        <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                        {% set compteur = 0 %}
                                        {% for participant  in sortie.participants %}
                                            {% set compteur = compteur+1 %}
                                        {% endfor %}
                                        <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                        <td>{{ sortie.etat }}</td>
                                        <td>{{ sortie.participant }}</td>
                                        <td>
                                            <ul>
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                                </li>

                                                {% if app.user == sortie.participant %}
                                                    <li>
                                                        <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                    </li>
                                                {% endif %}
                                                {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                            désister</a>
                                                    </li>
                                                {% else %}
                                                    {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                        <li>
                                                            <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                        </li>
                                                    {% endif %}
                                                {% endif %}
                                            </ul>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="sorties2" id="text2" hidden>
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="table-responsive" style="max-height: 350px">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom de la sortie</th>
                            <th>Date de la sortie</th>
                            <th>Clotûre</th>
                            <th>Inscripts/places</th>
                            <th>Etat</th>
                            <th>Organisateur</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="myTable">
                        {% for sortie in sorties %}
                            {% set dateSortie = sortie.getDateDebutSortie() %}
                            {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                {% if sortie.participants.contains(app.user) %}
                                    <tr>
                                        <td>{{ sortie.nomSortie }}</td>
                                        <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                        <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                        {% set compteur = 0 %}
                                        {% for participant  in sortie.participants %}
                                            {% set compteur = compteur+1 %}
                                        {% endfor %}
                                        <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                        <td>{{ sortie.etat }}</td>
                                        <td>{{ sortie.participant }}</td>
                                        <td>
                                            <ul>
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                                </li>

                                                {% if app.user == sortie.participant %}
                                                    <li>
                                                        <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                    </li>
                                                {% endif %}
                                                {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                            désister</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endif %}

                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="sorties3" id="text3" hidden>
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="table-responsive" style="max-height: 350px">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom de la sortie</th>
                            <th>Date de la sortie</th>
                            <th>Clotûre</th>
                            <th>Inscripts/places</th>
                            <th>Etat</th>
                            <th>Organisateur</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="myTable">
                        {% for sortie in sorties %}
                            {% if app.user != sortie.participant %}
                                {% if sortie.participants.contains(app.user) %}
                                {% else %}
                                    {% set dateSortie = sortie.getDateDebutSortie() %}
                                    {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                        <tr>
                                            <td>{{ sortie.nomSortie }}</td>
                                            <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                            <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                            {% set compteur = 0 %}
                                            {% for participant  in sortie.participants %}
                                                {% set compteur = compteur+1 %}
                                            {% endfor %}
                                            <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                            <td>{{ sortie.etat }}</td>
                                            <td>{{ sortie.participant }}</td>
                                            <td>
                                                <ul>
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                                    </li>

                                                    {% if app.user == sortie.participant %}
                                                        <li>
                                                            <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                        </li>
                                                    {% endif %}
                                                    {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                        <li>
                                                            <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                                désister</a>
                                                        </li>
                                                    {% else %}
                                                        {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte" %}
                                                            <li>
                                                                <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                            </li>
                                                        {% endif %}
                                                    {% endif %}
                                                </ul>
                                            </td>
                                        </tr>
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="sorties4" id="text4" hidden>
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="table-responsive" style="max-height: 350px">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom de la sortie</th>
                            <th>Date de la sortie</th>
                            <th>Clotûre</th>
                            <th>Inscripts/places</th>
                            <th>Etat</th>
                            <th>Organisateur</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="myTable">
                        {% for sortie in sorties %}
                            {% if date()>sortie.getDateDebutSortie() %}
                                {% set dateSortie = sortie.getDateDebutSortie() %}
                                {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                    <tr>
                                        <td>{{ sortie.nomSortie }}</td>
                                        <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                        <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                        {% set compteur = 0 %}
                                        {% for participant  in sortie.participants %}
                                            {% set compteur = compteur+1 %}
                                        {% endfor %}
                                        <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                        <td>{{ sortie.etat }}</td>
                                        <td>{{ sortie.participant }}</td>
                                        <td>
                                            <ul>
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                                </li>

                                                {% if app.user == sortie.participant %}
                                                    <li>
                                                        <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                    </li>
                                                {% endif %}
                                                {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                            désister</a>
                                                    </li>
                                                {% else %}
                                                    {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                        <li>
                                                            <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                        </li>
                                                    {% endif %}
                                                {% endif %}
                                            </ul>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="saintErblain" id="text5" hidden>
    <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
            <div class="table-responsive" style="max-height: 350px">
                <table class="table">
                    <thead>
                    <tr>
                        <th>Nom de la sortie</th>
                        <th>Date de la sortie</th>
                        <th>Clotûre</th>
                        <th>Inscripts/places</th>
                        <th>Etat</th>
                        <th>Organisateur</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody id="myTable">
                    {% for sortie in sorties %}
                        {% if sortie.getSite.nomSite == 'Saint-herblain' %}

                            {% set dateSortie = sortie.getDateDebutSortie() %}
                            {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                <tr>
                                    <td>{{ sortie.nomSortie }}</td>
                                    <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                    <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                    {% set compteur = 0 %}
                                    {% for participant  in sortie.participants %}
                                        {% set compteur = compteur+1 %}
                                    {% endfor %}
                                    <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                    <td>{{ sortie.etat }}</td>
                                    <td>{{ sortie.participant }}</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                            </li>

                                            {% if app.user == sortie.participant %}
                                                <li>
                                                    <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                </li>
                                            {% endif %}
                                            {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                        désister</a>
                                                </li>
                                            {% else %}
                                                {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="chartresBretagne" id="text6" hidden>
    <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
            <div class="table-responsive" style="max-height: 350px">
                <table class="table">
                    <thead>
                    <tr>
                        <th>Nom de la sortie</th>
                        <th>Date de la sortie</th>
                        <th>Clotûre</th>
                        <th>Inscripts/places</th>
                        <th>Etat</th>
                        <th>Organisateur</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody id="myTable">
                    {% for sortie in sorties %}
                        {% if sortie.getSite == 'Chartres de Bretagne' %}

                            {% set dateSortie = sortie.getDateDebutSortie() %}
                            {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                <tr>
                                    <td>{{ sortie.nomSortie }}</td>
                                    <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                    <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                    {% set compteur = 0 %}
                                    {% for participant  in sortie.participants %}
                                        {% set compteur = compteur+1 %}
                                    {% endfor %}
                                    <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                    <td>{{ sortie.etat }}</td>
                                    <td>{{ sortie.participant }}</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                            </li>

                                            {% if app.user == sortie.participant %}
                                                <li>
                                                    <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                </li>
                                            {% endif %}
                                            {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte"%}
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                        désister</a>
                                                </li>
                                            {% else %}
                                                {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="rocheSurYon" id="text7" hidden>
    <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
            <div class="table-responsive" style="max-height: 350px">
                <table class="table">
                    <thead>
                    <tr>
                        <th>Nom de la sortie</th>
                        <th>Date de la sortie</th>
                        <th>Clotûre</th>
                        <th>Inscripts/places</th>
                        <th>Etat</th>
                        <th>Organisateur</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody id="myTable">
                    {% for sortie in sorties %}
                        {% if sortie.getSite == 'La Roche Sur Yon' %}
                            {% set dateSortie = sortie.getDateDebutSortie() %}
                            {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                <tr>
                                    <td>{{ sortie.nomSortie }}</td>
                                    <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                    <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                    {% set compteur = 0 %}
                                    {% for participant  in sortie.participants %}
                                        {% set compteur = compteur+1 %}
                                    {% endfor %}
                                    <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                    <td>{{ sortie.etat }}</td>
                                    <td>{{ sortie.participant }}</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                            </li>

                                            {% if app.user == sortie.participant %}
                                                <li>
                                                    <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                </li>
                                            {% endif %}
                                            {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte" %}
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                        désister</a>
                                                </li>
                                            {% else %}
                                                {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="quimper" id="text8" hidden>
    <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
            <div class="table-responsive" style="max-height: 350px">
                <table class="table">
                    <thead>
                    <tr>
                        <th>Nom de la sortie</th>
                        <th>Date de la sortie</th>
                        <th>Clotûre</th>
                        <th>Inscripts/places</th>
                        <th>Etat</th>
                        <th>Organisateur</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody id="myTable">
                    {% for sortie in sorties %}
                        {% if sortie.getSite == 'Quimper' %}
                            {% set dateSortie = sortie.getDateDebutSortie() %}
                            {% if dateDuJour.diff(dateSortie).format('%R%a') >= -30 %}
                                <tr>
                                    <td>{{ sortie.nomSortie }}</td>
                                    <td>{% if sortie.dateDebutSortie %}{{ sortie.dateDebutSortie|date('d - m - Y') }}{% endif %}</td>
                                    <td>{% if sortie.dateCloture %}{{ sortie.dateCloture|date('d - m - Y') }}{% endif %}</td>
                                    {% set compteur = 0 %}
                                    {% for participant  in sortie.participants %}
                                        {% set compteur = compteur+1 %}
                                    {% endfor %}
                                    <td>{{ compteur }}/{{ sortie.nbInscriptionMax }}</td>
                                    <td>{{ sortie.etat }}</td>
                                    <td>{{ sortie.participant }}</td>
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Afficher</a>
                                            </li>

                                            {% if app.user == sortie.participant %}
                                                <li>
                                                    <a href="{{ path('sortie_edit', { 'id': sortie.id }) }}">Modifier</a>
                                                </li>
                                            {% endif %}
                                            {% if sortie.participants.contains(app.user) and sortie.etat == "Ouverte" %}
                                                <li>
                                                    <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">Se
                                                        désister</a>
                                                </li>
                                            {% else %}
                                                {% if compteur < sortie.nbInscriptionMax and sortie.dateCloture >= dateDuJour and sortie.etat == "Ouverte"%}
                                                    <li>
                                                        <a href="{{ path('sortie_show', { 'id': sortie.id }) }}">S'inscrire</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<br>
<div class="row">
    <div class="col-sm-3 col-sm-offset-3">
        <div class="form-group">
            <a class="btn btn-success btn-lg" href="{{ path('sortie_new') }}"> Créer une sortie</a>
        </div>
    </div>
</div>
</div>
{% endblock %}

</main>
</body>
{#------------------------------------------------Footer---------------------------------------------------------------#}
<footer>
    <div>
        &nbsp; &nbsp; &copy; ENI Ecole Mentions légales et protection des données {{ "now" | date('Y') }}
    </div>
</footer>
</html>